# FontGen3 v1.00 - フォント制作ツールキット

高品質なビットマップフォントの制作とTTF/BDF形式での書き出しが可能な統合フォント制作環境です。

## 📦 構成

- **font_editor_main1.00.py** - メインフォントエディタ (225KB)
- **font_parts_extractor1.00.py** - 偏旁抽出ツール (84KB)

---

## ⚡ クイックスタート

### 1. 偏旁（部首）を抽出

```bash
python font_parts_extractor1.00.py
```

1. フォントファイルを選択（TTF/OTF/TTC対応）
2. 出力先を指定（デフォルト: `assets/parts`）
3. 「抽出開始」ボタンをクリック
4. 完了後、`assets/parts`に部首画像とmetadata.jsonが生成される

### 2. フォントを編集

```bash
python font_editor_main1.00.py
```

1. 「フォントを開く」でベースフォントを読み込み
2. 「ファイル」→「部首フォルダをインポート」で抽出した部首をインポート
3. グリッド上の文字をクリックして編集
4. 「部首」ボタンから部首パレットを開き、部首を配置
5. 「エクスポート」→「TTF形式で保存」で完成

---

## 🎯 主要機能

### フォントエディタ (font_editor_main1.00.py)

#### ✅ 編集機能
- **高解像度編集**: 2048x2048pxキャンバスで精密な編集
- **描画ツール**: ペン、消しゴム、直線、矩形、楕円、塗りつぶし
- **変形機能**: 上下左右反転、選択領域の移動・リサイズ
- **テキスト挿入**: フォントから文字を挿入、エッジ効果付き
- **アンドゥ/リドゥ**: 無制限の編集履歴

#### ✅ ファイル対応
- **読み込み**: TTF、OTF、TTC（複数フォント選択可能）
- **書き出し**:
  - TTF形式（高品質アウトライン変換、ハイブリッドマージ方式）
  - BDF形式（ビットマップフォント）
  - PNG一括書き出し

#### ✅ 部首機能
- **部首パレット**: カテゴリ別（偏、旁、冠、脚、構、垂、繞）に整理
- **部首インポート**: 偏旁抽出ツールで生成したデータを直接インポート
- **ドラッグ&ドロップ**: 部首をグリフ編集画面に簡単配置

#### ✅ その他
- **バックグラウンド読み込み**: 全文字範囲を自動で非同期読み込み
- **グリフフィルタ**: 編集済み/空白/全てのフィルタリング
- **テキストプレビュー**: 実際の文章で表示確認
- **保存進捗バー**: プロジェクト保存時の進捗を可視化

---

### 偏旁抽出ツール (font_parts_extractor1.00.py)

#### ✅ 抽出機能
- **動的境界検出**: 文字の形状に応じて最適な分割位置を自動検出
- **高解像度**: 2048x2048pxで抽出
- **カテゴリ対応**:
  - 偏（へん）: 左側部首
  - 旁（つくり）: 右側部首
  - 冠（かんむり）: 上側部首
  - 脚（あし）: 下側部首
  - 構（かまえ）: 囲み部首
  - 垂（たれ）: 垂れ下がり部首
  - 繞（にょう）: 包み込み部首

#### ✅ 出力形式
- **画像**: 透過PNG形式（部首名.png）
- **メタデータ**:
  - `metadata.json` - font_editor互換形式
  - `parts_catalog.json` - 独自カタログ形式（後方互換）

---

## 💡 ワークフロー例

### パターン1: ゼロから漢字フォントを作る

```
1. ベースフォントを用意
   └─ 既存フォント(例: Noto Sans CJK)

2. 偏旁抽出ツールで部首を抽出
   └─ assets/parts/ に200個以上の部首が生成される

3. フォントエディタで編集
   ├─ ベースフォントを読み込み
   ├─ 部首をインポート
   ├─ 各文字を編集（部首を組み合わせる）
   └─ TTF形式で書き出し

4. 完成！
```

### パターン2: 既存フォントを微調整

```
1. フォントエディタで既存フォントを開く
2. 気になる文字だけを編集
3. TTF形式で書き出し
   └─ ハイブリッドマージ方式により、
      未編集の文字は元のアウトラインを維持
```

---

## 🔧 必要な環境

### Python環境

- **Python**: 3.8以上
- **必須ライブラリ**:
  ```bash
  pip install pillow
  ```

### TTF書き出し（オプション）

フォントエディタでTTF形式の書き出しを使用する場合:

```bash
# fontTools
pip install fonttools

# potrace (アウトライン変換用)
# Mac
brew install potrace

# Linux (Ubuntu/Debian)
sudo apt-get install potrace

# Windows
# http://potrace.sourceforge.net/ からダウンロード
```

---

## 📋 バージョニングルール

- **+0.01**: 小さな改良（バグ修正、UI微調整）
- **+0.1**: 中程度の機能追加（新機能、UX改善）
- **+1.0**: メジャーアップデート（決定版リリース）

---

## 🎨 キーボードショートカット（エディタ）

| ショートカット | 機能 |
|--------------|------|
| **Ctrl+S** | 保存 |
| **Ctrl+Z** | 元に戻す |
| **Ctrl+Y** | やり直し |
| **Ctrl+C** | コピー |
| **Ctrl+X** | 切り取り |
| **Ctrl+V** | 貼り付け |
| **Ctrl+O** | フォントを開く |
| **Ctrl+F** | グリフフィルタ |
| **Ctrl+P** | テキストプレビュー |
| **Delete** | 選択領域を削除 |
| **Esc** | 選択解除 |
| **Space** | 一時的にパンモード |
| **↑↓←→** | 選択領域を1pxずつ移動 |

---

## 📂 プロジェクト構造

### フォントエディタプロジェクト（.fproj）

```
MyFont.fproj/
├── metadata.json         # プロジェクト情報
├── glyphs/              # グリフ画像
│   ├── U+0041.png      # 'A'
│   ├── U+0042.png      # 'B'
│   └── ...
└── parts/               # 部首データ
    ├── metadata.json
    ├── にんべん.png
    ├── さんずい.png
    └── ...
```

### 偏旁抽出ツール出力

```
assets/parts/
├── metadata.json        # font_editor互換
├── parts_catalog.json   # 独自形式
├── にんべん.png
├── さんずい.png
├── ごんべん.png
└── ...
```

---

## ❓ トラブルシューティング

### Q: TTCファイルが開けない
A: ファイル選択時に自動的にフォント選択ダイアログが表示されます。含まれるフォントを選択してください。

### Q: 保存に時間がかかる
A: v1.00から保存進捗バーが表示されるようになりました。大量のグリフがある場合は数分かかることがあります。

### Q: 部首パレットに何も表示されない
A: 「ファイル」→「部首フォルダをインポート」から、偏旁抽出ツールで生成したフォルダを選択してください。

### Q: TTF書き出しでエラーが出る
A: potraceとfontToolsがインストールされているか確認してください:
```bash
potrace --version
pip show fonttools
```

---

## 📝 ライセンス

MIT License

---

## 🔗 関連リンク

- **GitHub**: https://github.com/Naoking55/fontgen3
- **Issue報告**: https://github.com/Naoking55/fontgen3/issues

---

## 📌 更新履歴

### v1.00 (2025-11-10)
- ✅ TTCファイル対応
- ✅ プロジェクト保存進捗バー
- ✅ parts_extractor連携強化
- ✅ 部首フォルダインポート機能
- ✅ バージョン管理統一

### 今後の予定
- v1.01: エラーメッセージ改善、設定ファイル対応
- v1.10: ヘルプ機能、ショートカットキー一覧
- v2.00: 統合ランチャー、プロジェクト管理機能

---

**Happy Font Making! 🎨✨**
